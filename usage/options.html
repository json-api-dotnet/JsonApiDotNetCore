<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Global Options </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Global Options ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="global-options">Global Options</h1>

<p>Configuration can be applied when adding services to the dependency injection container at startup.</p>
<pre><code class="lang-c#">// Program.cs
builder.Services.AddJsonApi&lt;AppDbContext&gt;(options =&gt;
{
    // Configure the options here...
});
</code></pre><h2 id="client-generated-ids">Client Generated IDs</h2>
<p>By default, the server will respond with a 403 Forbidden HTTP Status Code if a POST request is received with a client-generated ID.</p>
<p>However, this can be allowed by setting the AllowClientGeneratedIds flag in the options:</p>
<pre><code class="lang-c#">options.AllowClientGeneratedIds = true;
</code></pre><h2 id="pagination">Pagination</h2>
<p>The default page size used for all resources can be overridden in options (10 by default). To disable paging, set it to <code>null</code>.
The maximum page size and number allowed from client requests can be set too (unconstrained by default).
You can also include the total number of resources in each response. Note that when using this feature, it does add some query overhead since we have to also request the total number of resources.</p>
<pre><code class="lang-c#">options.DefaultPageSize = new PageSize(25);
options.MaximumPageSize = new PageSize(100);
options.MaximumPageNumber = new PageNumber(50);
options.IncludeTotalResourceCount = true;
</code></pre><p>To retrieve the total number of resources on secondary and relationship endpoints, the reverse of the relationship must to be available. For example, in <code>GET /customers/1/orders</code>, both the relationships <code>[HasMany] Customer.Orders</code> and <code>[HasOne] Order.Customer</code> must be defined.
If <code>IncludeTotalResourceCount</code> is set to <code>false</code> (or the inverse relationship is unavailable on a non-primary endpoint), best-effort paging links are returned instead. This means no <code>last</code> link and the <code>next</code> link only occurs when the current page is full.</p>
<h2 id="relative-links">Relative Links</h2>
<p>All links are absolute by default. However, you can configure relative links.</p>
<pre><code class="lang-c#">options.UseRelativeLinks = true;
</code></pre><pre><code class="lang-json">{
  &quot;type&quot;: &quot;articles&quot;,
  &quot;id&quot;: &quot;4309&quot;,
  &quot;relationships&quot;: {
     &quot;author&quot;: {
       &quot;links&quot;: {
         &quot;self&quot;: &quot;/api/v1/articles/4309/relationships/author&quot;,
         &quot;related&quot;: &quot;/api/v1/articles/4309/author&quot;
       }
     }
  }
}
</code></pre><h2 id="unknown-query-string-parameters">Unknown Query String Parameters</h2>
<p>If you would like to allow unknown query string parameters (parameters not reserved by the JSON:API specification or registered using resource definitions), you can set <code>AllowUnknownQueryStringParameters = true</code>. When set to <code>false</code> (the default), an HTTP 400 Bad Request is returned for unknown query string parameters.</p>
<pre><code class="lang-c#">options.AllowUnknownQueryStringParameters = true;
</code></pre><h2 id="maximum-include-depth">Maximum include depth</h2>
<p>To limit the maximum depth of nested includes, use <code>MaximumIncludeDepth</code>. This is null by default, which means unconstrained. If set and a request exceeds the limit, an HTTP 400 Bad Request is returned.</p>
<pre><code class="lang-c#">options.MaximumIncludeDepth = 1;
</code></pre><h2 id="customize-serializer-options">Customize Serializer options</h2>
<p>We use <a href="https://www.nuget.org/packages/System.Text.Json">System.Text.Json</a> for all serialization needs.
If you want to change the default serializer options, you can:</p>
<pre><code class="lang-c#">options.SerializerOptions.WriteIndented = true;
options.SerializerOptions.ReferenceHandler = ReferenceHandler.Preserve;
options.SerializerOptions.Converters.Add(new JsonStringEnumConverter());
</code></pre><p>The default naming convention (as used in the routes and resource/attribute/relationship names) is also determined here, and can be changed (default is camel-case):</p>
<pre><code class="lang-c#">// Use Pascal case
options.SerializerOptions.PropertyNamingPolicy = null;
options.SerializerOptions.DictionaryKeyPolicy = null;
</code></pre><p>Because we copy resource properties into an intermediate object before serialization, JSON annotations such as <code>[JsonPropertyName]</code> and <code>[JsonIgnore]</code> on <code>[Attr]</code> properties are ignored.</p>
<h2 id="modelstate-validation">ModelState Validation</h2>
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/models/validation">ASP.NET ModelState validation</a> can be used to validate incoming request bodies when creating and updating resources. Since v5.0, this is enabled by default.
When <code>ValidateModelState</code> is set to <code>false</code>, no model validation is performed.</p>
<p>How nullability affects ModelState validation is described <a href="resources/nullability.html">here</a>.</p>
<pre><code class="lang-c#">options.ValidateModelState = true;
</code></pre><pre><code class="lang-c#">#nullable enable

public class Person : Identifiable&lt;int&gt;
{
    [Attr]
    [MinLength(3)]
    public string FirstName { get; set; } = null!;

    [Attr]
    [Required]
    public int? Age { get; set; }

    [HasOne]
    public LoginAccount Account { get; set; } = null!;
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/json-api-dotnet/JsonApiDotNetCore/blob/master/docs/usage/options.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
