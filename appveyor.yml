image:
  - Visual Studio 2022
  - Ubuntu

version: '{build}'

stack: postgresql 13.4

environment:
  PGUSER: postgres
  PGPASSWORD: Password12!

branches:
  only:
  - master
  - develop
  - unstable
  - /release\/.+/

pull_requests:
  do_not_increment_build_number: true

nuget:
  disable_publish_on_pr: true

matrix:
  fast_finish: true

for:
-
  matrix:
    only:
    - image: Visual Studio 2022
  services:
  - postgresql13
  # REF: https://github.com/docascode/docfx-seed/blob/master/appveyor.yml

build_script:
- pwsh: |
    Write-Output ".NET version:"
    dotnet --version

    Write-Output "PostgreSQL version:"
    if ($IsWindows) {
        . "${env:ProgramFiles}\PostgreSQL\13\bin\psql" --version
    }
    else {
        psql --version
    }

    .\Build.ps1

test: off
